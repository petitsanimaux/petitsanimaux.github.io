{"version":3,"file":"component---src-templates-cart-js-95c54ec0d28212852bae.js","mappings":"uIACO,MAAMA,EAAgBA,CAACC,EAASC,KAC5B,IACAD,EACHE,WAAYD,EAAOE,MAAKC,IAAUA,EAAMC,aAAe,IAAIC,SAAWN,EAAQO,aAAaD,SAC3FE,WAAY,CACRR,EAAQS,OAAM,WAAcT,EAAQS,OAAW,KAC/CT,EAAQU,MAAK,UAAaV,EAAQU,MAAU,KAC5CV,EAAQW,OAAM,WAAcX,EAAQW,OAAW,MACjDC,QAAOC,GAAKA,K,qCCItB,IATgBC,GAGRC,EAAAA,cAAA,SAAAC,OAAAC,OAAA,CAAQC,UAAU,UAAaJ,GAC1BA,EAAMK,S,0ICRfC,EAAS,2BACTC,EAAe,4CACfC,EAA0B,mJA2C1BC,EAAgB,KAChBC,EAAa,SAAoBC,GAEnC,OAAsB,OAAlBF,IAIJA,EAAgB,IAAIG,SAAQ,SAAUC,EAASC,GAC7C,GAAsB,oBAAXC,QAA8C,oBAAbC,SAW5C,GAJID,OAAOE,QAAUN,GACnBO,QAAQC,KAAKX,GAGXO,OAAOE,OACTJ,EAAQE,OAAOE,aAIjB,IACE,IAAIG,EAnEO,WAGf,IAFA,IAAIC,EAAUL,SAASM,iBAAiB,gBAAiBC,OAAOjB,EAAQ,OAE/DkB,EAAI,EAAGA,EAAIH,EAAQ1B,OAAQ6B,IAAK,CACvC,IAAIJ,EAASC,EAAQG,GAErB,GAAKjB,EAAakB,KAAKL,EAAOM,KAI9B,OAAON,CACT,CAEA,OAAO,IACT,CAqDmBO,GAETP,GAAUT,EACZO,QAAQC,KAAKX,GACHY,IACVA,EAxDW,SAAsBT,GACvC,IAAIiB,EAAcjB,IAAWA,EAAOkB,qBAAuB,8BAAgC,GACvFT,EAASJ,SAASc,cAAc,UACpCV,EAAOM,IAAM,GAAGH,OAAOjB,GAAQiB,OAAOK,GACtC,IAAIG,EAAaf,SAASgB,MAAQhB,SAASiB,KAE3C,IAAKF,EACH,MAAM,IAAIG,MAAM,+EAIlB,OADAH,EAAWI,YAAYf,GAChBA,CACT,CA4CiBgB,CAAazB,IAGxBS,EAAOiB,iBAAiB,QAAQ,WAC1BtB,OAAOE,OACTJ,EAAQE,OAAOE,QAEfH,EAAO,IAAIoB,MAAM,2BAErB,IACAd,EAAOiB,iBAAiB,SAAS,WAC/BvB,EAAO,IAAIoB,MAAM,4BACnB,GACF,CAAE,MAAOI,GAEP,YADAxB,EAAOwB,EAET,MAnCEzB,EAAQ,KAoCZ,KA3CSJ,CA6CX,EAaI8B,EAAkB3B,QAAQC,UAAU2B,MAAK,WAC3C,OAAO9B,EAAW,KACpB,IACI+B,GAAa,EACjBF,EAAuB,OAAE,SAAUG,GAC5BD,GACHvB,QAAQC,KAAKuB,EAEjB,IACA,IAAIC,EAAa,WACf,IAAK,IAAIC,EAAOC,UAAUlD,OAAQmD,EAAO,IAAIC,MAAMH,GAAOI,EAAO,EAAGA,EAAOJ,EAAMI,IAC/EF,EAAKE,GAAQH,UAAUG,GAGzBP,GAAa,EACb,IAAIQ,EAAYC,KAAKC,MACrB,OAAOZ,EAAgBC,MAAK,SAAUY,GACpC,OA7Ba,SAAoBA,EAAaN,EAAMG,GACtD,GAAoB,OAAhBG,EACF,OAAO,KAGT,IAAIC,EAASD,EAAYE,WAAMC,EAAWT,GAE1C,OArEoB,SAAyBO,EAAQJ,GAChDI,GAAWA,EAAOG,kBAIvBH,EAAOG,iBAAiB,CACtBC,KAAM,YACNC,QAAS,SACTT,UAAWA,GAEf,CA0DEU,CAAgBN,EAAQJ,GACjBI,CACT,CAqBWO,CAAWR,EAAaN,EAAMG,EACvC,GACF,EC1HA,MAAMY,EAAoB,iCAuC1B,MArCA,SAAwB7D,GACpB,MAAM,UAAC8D,GAAa9D,GACbqD,EAAQU,GAAa9D,EAAAA,SAAe,MA8B3C,OA5BAA,EAAAA,WAAgB,MACZ+D,iBACI,MAAMC,QAAkBtB,EAAW,+GACnCoB,EAAUE,EACd,CACAC,EAAa,GACd,IAuBCjE,EAAAA,cAACkE,EAAAA,EAAM,CAACC,UAAWf,GAA+B,IAArBS,EAAUnE,OAAc0E,QArBxCL,UACb,IAAKX,EACD,OAGJ,MAAM,MAAEf,SAAgBe,EAAOiB,mBAAmB,CAC9CR,UAAU,CAAE,CACRS,MAAOV,EACPW,SAAU,IACbjD,QAAAkD,EAAAA,EAAAA,GAAKX,IACNY,KAAM,UACNC,yBAA0B,WAC1BC,0BAA2B,CACvBC,iBAAkB,CAAC,OAEvBC,WAAY,kCACZC,UAAW,4BACb,GAIsE,WAEhF,E,oBCDA,MAlCkB/E,IACd,MAAM,QAACd,EAAO,eAAE8F,EAAc,QAAEC,EAAO,GAAEC,EAAE,SAAEV,GAAYxE,GACnD,WAAEZ,EAAU,KAAEqE,EAAI,MAAEc,GAASrF,EAEnC,OACIe,EAAAA,cAAA,OAAKG,UAAU,yBACXH,EAAAA,cAAA,OAAKG,UAAU,0BACXH,EAAAA,cAACkF,EAAAA,EAAW,CACRC,OAAOC,EAAAA,EAAAA,GAASjG,EAAWkG,MAC3BC,IAAK9B,KAIbxD,EAAAA,cAAA,OAAKG,UAAU,gCACXH,EAAAA,cAACuF,EAAAA,GAAE,KAAE/B,GACTxD,EAAAA,cAACwF,EAAAA,GAAE,KAAC,IAAElB,IAGNtE,EAAAA,cAAA,OAAKG,UAAU,uCACXH,EAAAA,cAAA,UAAQoE,QAASA,KACbW,EAAeC,EAASC,EAAIV,EAAW,EAAE,GAC1C,KACHvE,EAAAA,cAAA,YAAOuE,GACPvE,EAAAA,cAAA,UAAQoE,QAASA,KACbW,EAAeC,EAASC,EAAIV,EAAW,EAAE,GAC1C,MAGPvE,EAAAA,cAAA,UAAQoE,QAASA,KAAOW,EAAeC,EAASC,EAAI,EAAE,GAAI,UAExD,E,oBCad,MAvCclF,IACV,MAAM,SAAE0F,GAAa1F,EACf2F,GAAYC,EAAAA,EAAAA,IAAaC,EAAAA,GAAAA,OACzB,KAAEC,EAAI,eAAEd,IAAkBe,EAAAA,EAAAA,YAAWC,EAAAA,GAE3C,OAAKL,EAIe,IAAhBG,EAAKnG,OAEDM,EAAAA,cAAA,OAAKG,UAAU,YAAW,gCAO9BH,EAAAA,cAAA,OAAKG,UAAU,YACV0F,EAAKG,KAAIC,IACN,MAAM,GAAChB,EAAE,QAAED,EAAO,SAAET,GAAY0B,EAC1BhH,EAAUwG,EAASrG,MAAKH,GAAWA,EAAQgG,KAAOA,IAExD,OACIjF,EAAAA,cAACkG,EAAQ,CACLC,IAAKlB,EACLA,GAAIA,EACJD,QAASA,EACTT,SAAUA,EACVtF,QAASA,EACT8F,eAAgBA,GAClB,IAGV/E,EAAAA,cAACoG,EAAQ,CAACvC,UAAWgC,EAAKG,KAAIC,IAAI,CAAM3B,MAAO2B,EAAKjB,QAAST,SAAU0B,EAAK1B,gBA5BzE,IA6BD,E,oBClBP,SAAS8B,EAAKtG,GACjB,MAAM,0CACFuG,GACAvG,EAAMwG,KAGJA,EAAO,CACTC,KAAM,CACFhD,KAJK8C,EAA0CG,MAAM,GAI1CjD,OAInB,OAAOxD,EAAAA,cAAC0G,EAAAA,EAAUzG,OAAAC,OAAA,GAAKH,EAAK,CAAEwG,KAAMA,IACxC,CA+BA,MA9DsBxG,IAClB,MAAM,0CACFuG,EAAyC,qBACzCK,GACA5G,EAAMwG,KAEJd,EAAWa,EAA0CG,MAAMT,KAAKO,IAClDvH,EAAAA,EAAAA,GAAcuH,EAAMI,EAAqBF,SAI7D,OACEzG,EAAAA,cAAC4G,EAAAA,EAAkB,KACjB5G,EAAAA,cAAC6G,EAAI,CAACpB,SAAUA,IACG,C","sources":["webpack://wedding/./src/graphql/products.js","webpack://wedding/./src/layout/components/Button/index.js","webpack://wedding/./node_modules/@stripe/stripe-js/dist/stripe.esm.js","webpack://wedding/./src/layout/components/Checkout/index.js","webpack://wedding/./src/layout/components/CartItem/index.js","webpack://wedding/./src/layout/pages/Cart/index.js","webpack://wedding/./src/templates/cart.js"],"sourcesContent":["\nexport const formatProduct = (product, photos) => {\n    return {\n        ...product,\n        coverPhoto: photos.find(photo => (photo.description || \"\").trim() === product.coverPhotoId.trim()),\n        dimensions: [\n            product.length ? `Length: ${product.length}` : null,\n            product.width ? `Width: ${product.width}` : null,\n            product.height ? `Height: ${product.height}` : null,\n        ].filter(a => a),\n    }\n}\n","import * as React from \"react\";\n\nimport \"./styles.scss\";\n\nconst Button = (props) => {\n\n    return (\n        <button className=\"Button\" {...props}>\n            {props.children}\n        </button>\n    );\n};\n\nexport default Button;","var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.52.1\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","import * as React from \"react\";\nimport Button from \"../Button\";\nimport {loadStripe} from '@stripe/stripe-js';\n\nconst SHIPPING_PRICE_ID = \"price_1NAPJrBLdrhwtT8MG1ExlgPh\";\n\nfunction CheckoutButton(props) {\n    const {lineItems} = props;\n    const [stripe, setStripe] = React.useState(null);\n\n    React.useEffect(() => {\n        async function fetchStripe() {\n            const stripeObj = await loadStripe('pk_live_51MbzZWBLdrhwtT8MQVnLB1gU0MwJOrOtPZDvLSoUNHryAm0P1je9wct7pWxtNmEhhxtOazi64BrcuF7jptOvZnVj00fSmORI80');\n            setStripe(stripeObj);\n        }\n        fetchStripe();\n    }, []);\n\n    const checkout = async () => {\n        if (!stripe) {\n            return;\n        }\n\n        const { error } = await stripe.redirectToCheckout({\n            lineItems: [{\n                price: SHIPPING_PRICE_ID,\n                quantity: 1,\n            }, ...lineItems],\n            mode: 'payment',\n            billingAddressCollection: 'required',\n            shippingAddressCollection: {\n                allowedCountries: ['US'],\n            },\n            successUrl: 'https://crochetnest.com/success',\n            cancelUrl: 'https://crochetnest.com/',\n        });\n    };\n\n    return (\n        <Button disabled={!stripe || lineItems.length === 0} onClick={checkout}>Checkout</Button>\n    );\n};\n\nexport default CheckoutButton;","import React from \"react\";\nimport { H2, H3 } from \"../Header\";\nimport { GatsbyImage, getImage } from \"gatsby-plugin-image\";\n\nimport \"./styles.scss\";\n\nconst CartItem = (props) => {\n    const {product, updateQuantity, priceId, id, quantity} = props;\n    const { coverPhoto, name, price} = product;\n\n    return (\n        <div className=\"PetitsAnimauxCartItem\">\n            <div className=\"PetitsAnimauxCardImage\">\n                <GatsbyImage\n                    image={getImage(coverPhoto.file)}\n                    alt={name}\n                />\n            </div>\n\n            <div className=\"PetitsAnimauxCardTitleHeader\">\n                <H2>{name}</H2>\n            <H3>${price}</H3>\n            </div>\n\n            <div className=\"PetitsAnimauxCartQuantityController\">\n                <button onClick={() => {\n                    updateQuantity(priceId, id, quantity - 1);\n                }}>-</button>\n                <span>{quantity}</span>\n                <button onClick={() => {\n                    updateQuantity(priceId, id, quantity + 1);\n                }}>+</button>\n            </div>\n\n            <button onClick={() => {updateQuantity(priceId, id, 0);}}>Delete</button>\n\n        </div>\n    );\n}\n\nexport default CartItem;","import React, { useContext } from \"react\";\n\nimport Checkout from \"../../components/Checkout\";\nimport CartItem from \"../../components/CartItem\";\n\nimport useIsEnabled, { FLAGS } from \"../../../hooks/useIsEnabled\";\nimport cartContext from \"../../../context/cartContext\";\n\nimport \"./styles.scss\";\n\nconst Cart = (props) => {\n    const { products } = props;\n    const isEnabled = useIsEnabled(FLAGS.CART);\n    const { cart, updateQuantity} = useContext(cartContext);\n\n    if (!isEnabled) {\n        return null;\n    }\n\n    if (cart.length === 0) {\n        return (\n            <div className=\"CartPage\">\n                Add some items to your cart!\n            </div>\n        );\n    }\n\n    return (\n        <div className=\"CartPage\">\n            {cart.map(item => {\n                const {id, priceId, quantity} = item;\n                const product = products.find(product => product.id === id);\n\n                return (\n                    <CartItem \n                        key={id} \n                        id={id} \n                        priceId={priceId} \n                        quantity={quantity}\n                        product={product}\n                        updateQuantity={updateQuantity}\n                    />\n                );\n            })}\n            <Checkout lineItems={cart.map(item => ({price: item.priceId, quantity: item.quantity}))}/>\n        </div>\n    );\n};\n\nexport default Cart;","import { graphql } from \"gatsby\";\n\nimport React from \"react\";\nimport CommonHead from \"../layout/Head\";\nimport Cart from \"../layout/pages/Cart\";\nimport MainSectionWrapper from \"../layout\";\n\nimport {formatProduct} from \"../graphql/products\";\n\nconst PageTemplate = (props) => {\n    const {\n        allGoogleSpreadsheetPetitsAnimauxProducts,\n        allGooglePhotosPhoto,\n    } = props.data;\n\n    const products = allGoogleSpreadsheetPetitsAnimauxProducts.nodes.map((data) => {\n        const product = formatProduct(data, allGooglePhotosPhoto.nodes);\n        return product;\n    });\n\n    return (\n      <MainSectionWrapper>\n        <Cart products={products} />\n      </MainSectionWrapper>\n    )\n};\n\nexport function Head(props) {\n    const {\n        allGoogleSpreadsheetPetitsAnimauxProducts,\n    } = props.data;\n    const node = allGoogleSpreadsheetPetitsAnimauxProducts.nodes[0];\n\n    const data = {\n        page: {\n            name: node.name,\n        }\n    };\n\n    return <CommonHead {...props} data={data} />;\n}\n\nexport const query = graphql`\n  query PetitsAnimaux {\n    allGoogleSpreadsheetPetitsAnimauxProducts {\n      nodes {\n        name\n        id\n        price\n        coverPhotoId\n      }\n    }\n    \n    allGooglePhotosPhoto(filter: {album: {title: {eq: \"P2F\"} } }) {\n      nodes {\n        id\n        file {\n          childImageSharp {\n            gatsbyImageData(\n              height: 500\n            )\n          }\n          publicURL\n        }\n        description\n      }\n    }\n\n  }\n`;\n\nexport default PageTemplate;"],"names":["formatProduct","product","photos","coverPhoto","find","photo","description","trim","coverPhotoId","dimensions","length","width","height","filter","a","props","React","Object","assign","className","children","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripePromise","loadScript","params","Promise","resolve","reject","window","document","Stripe","console","warn","script","scripts","querySelectorAll","concat","i","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","error","stripePromise$1","then","loadCalled","err","loadStripe","_len","arguments","args","Array","_key","startTime","Date","now","maybeStripe","stripe","apply","undefined","_registerWrapper","name","version","registerWrapper","initStripe","SHIPPING_PRICE_ID","lineItems","setStripe","async","stripeObj","fetchStripe","Button","disabled","onClick","redirectToCheckout","price","quantity","_toConsumableArray","mode","billingAddressCollection","shippingAddressCollection","allowedCountries","successUrl","cancelUrl","updateQuantity","priceId","id","GatsbyImage","image","getImage","file","alt","H2","H3","products","isEnabled","useIsEnabled","FLAGS","cart","useContext","cartContext","map","item","CartItem","key","Checkout","Head","allGoogleSpreadsheetPetitsAnimauxProducts","data","page","nodes","CommonHead","allGooglePhotosPhoto","MainSectionWrapper","Cart"],"sourceRoot":""}