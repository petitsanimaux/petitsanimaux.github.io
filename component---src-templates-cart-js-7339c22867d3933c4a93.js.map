{"version":3,"file":"component---src-templates-cart-js-7339c22867d3933c4a93.js","mappings":"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","sources":["webpack://wedding/./src/graphql/products.js","webpack://wedding/./node_modules/@stripe/stripe-js/dist/stripe.esm.js","webpack://wedding/./src/layout/components/Checkout/index.js","webpack://wedding/./src/layout/pages/Cart/index.js","webpack://wedding/./src/templates/cart.js"],"sourcesContent":["\nexport const formatProduct = (product, photos) => {\n    return {\n        ...product,\n        coverPhoto: photos.find(photo => (photo.description || \"\").trim() === product.coverPhotoId.trim()),\n        dimensions: [\n            product.length ? `Length: ${product.length}` : null,\n            product.width ? `Width: ${product.width}` : null,\n            product.height ? `Height: ${product.height}` : null,\n        ].filter(a => a),\n    }\n}\n","var V3_URL = 'https://js.stripe.com/v3';\nvar V3_URL_REGEX = /^https:\\/\\/js\\.stripe\\.com\\/v3\\/?(\\?.*)?$/;\nvar EXISTING_SCRIPT_MESSAGE = 'loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used';\nvar findScript = function findScript() {\n  var scripts = document.querySelectorAll(\"script[src^=\\\"\".concat(V3_URL, \"\\\"]\"));\n\n  for (var i = 0; i < scripts.length; i++) {\n    var script = scripts[i];\n\n    if (!V3_URL_REGEX.test(script.src)) {\n      continue;\n    }\n\n    return script;\n  }\n\n  return null;\n};\n\nvar injectScript = function injectScript(params) {\n  var queryString = params && !params.advancedFraudSignals ? '?advancedFraudSignals=false' : '';\n  var script = document.createElement('script');\n  script.src = \"\".concat(V3_URL).concat(queryString);\n  var headOrBody = document.head || document.body;\n\n  if (!headOrBody) {\n    throw new Error('Expected document.body not to be null. Stripe.js requires a <body> element.');\n  }\n\n  headOrBody.appendChild(script);\n  return script;\n};\n\nvar registerWrapper = function registerWrapper(stripe, startTime) {\n  if (!stripe || !stripe._registerWrapper) {\n    return;\n  }\n\n  stripe._registerWrapper({\n    name: 'stripe-js',\n    version: \"1.52.1\",\n    startTime: startTime\n  });\n};\n\nvar stripePromise = null;\nvar loadScript = function loadScript(params) {\n  // Ensure that we only attempt to load Stripe.js at most once\n  if (stripePromise !== null) {\n    return stripePromise;\n  }\n\n  stripePromise = new Promise(function (resolve, reject) {\n    if (typeof window === 'undefined' || typeof document === 'undefined') {\n      // Resolve to null when imported server side. This makes the module\n      // safe to import in an isomorphic code base.\n      resolve(null);\n      return;\n    }\n\n    if (window.Stripe && params) {\n      console.warn(EXISTING_SCRIPT_MESSAGE);\n    }\n\n    if (window.Stripe) {\n      resolve(window.Stripe);\n      return;\n    }\n\n    try {\n      var script = findScript();\n\n      if (script && params) {\n        console.warn(EXISTING_SCRIPT_MESSAGE);\n      } else if (!script) {\n        script = injectScript(params);\n      }\n\n      script.addEventListener('load', function () {\n        if (window.Stripe) {\n          resolve(window.Stripe);\n        } else {\n          reject(new Error('Stripe.js not available'));\n        }\n      });\n      script.addEventListener('error', function () {\n        reject(new Error('Failed to load Stripe.js'));\n      });\n    } catch (error) {\n      reject(error);\n      return;\n    }\n  });\n  return stripePromise;\n};\nvar initStripe = function initStripe(maybeStripe, args, startTime) {\n  if (maybeStripe === null) {\n    return null;\n  }\n\n  var stripe = maybeStripe.apply(undefined, args);\n  registerWrapper(stripe, startTime);\n  return stripe;\n}; // eslint-disable-next-line @typescript-eslint/explicit-module-boundary-types\n\n// own script injection.\n\nvar stripePromise$1 = Promise.resolve().then(function () {\n  return loadScript(null);\n});\nvar loadCalled = false;\nstripePromise$1[\"catch\"](function (err) {\n  if (!loadCalled) {\n    console.warn(err);\n  }\n});\nvar loadStripe = function loadStripe() {\n  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n    args[_key] = arguments[_key];\n  }\n\n  loadCalled = true;\n  var startTime = Date.now();\n  return stripePromise$1.then(function (maybeStripe) {\n    return initStripe(maybeStripe, args, startTime);\n  });\n};\n\nexport { loadStripe };\n","import * as React from \"react\";\n\nimport {loadStripe} from '@stripe/stripe-js';\n\nconst SHIPPING_PRICE_ID = \"price_1NAPJrBLdrhwtT8MG1ExlgPh\";\n\nfunction CheckoutButton(props) {\n    const {lineItems} = props;\n    const [stripe, setStripe] = React.useState(null);\n\n    React.useEffect(() => {\n        async function fetchStripe() {\n            const stripeObj = await loadStripe('pk_live_51MbzZWBLdrhwtT8MQVnLB1gU0MwJOrOtPZDvLSoUNHryAm0P1je9wct7pWxtNmEhhxtOazi64BrcuF7jptOvZnVj00fSmORI80');\n            setStripe(stripeObj);\n        }\n        fetchStripe();\n    }, []);\n\n    const checkout = async () => {\n        if (!stripe) {\n            return;\n        }\n\n        const { error } = await stripe.redirectToCheckout({\n            lineItems: [{\n                price: SHIPPING_PRICE_ID,\n                quantity: 1,\n            }, ...lineItems],\n            mode: 'payment',\n            billingAddressCollection: 'required',\n            shippingAddressCollection: {\n                allowedCountries: ['US'],\n            },\n            successUrl: 'https://crochetnest.com/success',\n            cancelUrl: 'https://crochetnest.com/cancel',\n        });\n    };\n\n    return (\n        <button disabled={!stripe} onClick={checkout}>Buy</button>\n    );\n};\n\nexport default CheckoutButton;","import React, { useContext } from \"react\";\n\nimport { H2, H3 } from \"../../components/Header\";\nimport Checkout from \"../../components/Checkout\";\nimport { GatsbyImage, getImage } from \"gatsby-plugin-image\";\n\nimport useIsEnabled, { FLAGS } from \"../../../hooks/useIsEnabled\";\nimport cartContext from \"../../../context/cartContext\";\n\nconst Cart = (props) => {\n    const { products } = props;\n    const isEnabled = useIsEnabled(FLAGS.CART);\n    const { cart, updateQuantity} = useContext(cartContext);\n\n    if (!isEnabled) {\n        return null;\n    }\n\n    return (\n        <div>\n            {cart.map(item => {\n                const {id, priceId, quantity} = item;\n                const product = products.find(product => product.id === id);\n                const { coverPhoto, name, price} = product;\n                return (\n                    <div key={id}>\n                        <div className=\"PetitsAnimauxCardImage\">\n                            <GatsbyImage\n                                image={getImage(coverPhoto.file)}\n                                alt={name}\n                            />\n                        </div>\n                        <H2>{name}</H2>\n\n                        <div>\n                            <button onClick={() => {\n                                updateQuantity(priceId, id, quantity - 1);\n                            }}>-</button>\n                            <H3>{quantity}</H3>\n                            <button onClick={() => {\n                                updateQuantity(priceId, id, quantity + 1);\n                            }}>+</button>\n                        </div>\n\n                        <button onClick={() => {\n                                updateQuantity(priceId, id, 0);\n                            }}>Delete</button>\n\n                        <H3>${price}</H3>\n                    </div>\n                );\n            })}\n            <Checkout lineItems={cart.map(item => ({price: item.priceId, quantity: item.quantity}))}/>\n        </div>\n    );\n};\n\nexport default Cart;","import { graphql } from \"gatsby\";\n\nimport React from \"react\";\nimport CommonHead from \"../layout/Head\";\nimport Cart from \"../layout/pages/Cart\";\nimport MainSectionWrapper from \"../layout\";\n\nimport {formatProduct} from \"../graphql/products\";\n\nconst PageTemplate = (props) => {\n    const {\n        allGoogleSpreadsheetPetitsAnimauxProducts,\n        allGooglePhotosPhoto,\n    } = props.data;\n\n    const products = allGoogleSpreadsheetPetitsAnimauxProducts.nodes.map((data) => {\n        const product = formatProduct(data, allGooglePhotosPhoto.nodes);\n        return product;\n    });\n\n    return (\n      <MainSectionWrapper>\n        <Cart products={products} />\n      </MainSectionWrapper>\n    )\n};\n\nexport function Head(props) {\n    const {\n        allGoogleSpreadsheetPetitsAnimauxProducts,\n    } = props.data;\n    const node = allGoogleSpreadsheetPetitsAnimauxProducts.nodes[0];\n\n    const data = {\n        page: {\n            name: node.name,\n        }\n    };\n\n    return <CommonHead {...props} data={data} />;\n}\n\nexport const query = graphql`\n  query PetitsAnimaux {\n    allGoogleSpreadsheetPetitsAnimauxProducts {\n      nodes {\n        name\n        id\n        price\n        coverPhotoId\n      }\n    }\n    \n    allGooglePhotosPhoto(filter: {album: {title: {eq: \"P2F\"} } }) {\n      nodes {\n        id\n        file {\n          childImageSharp {\n            gatsbyImageData(\n              height: 500\n            )\n          }\n          publicURL\n        }\n        description\n      }\n    }\n\n  }\n`;\n\nexport default PageTemplate;"],"names":["formatProduct","product","photos","coverPhoto","find","photo","description","trim","coverPhotoId","dimensions","length","width","height","filter","a","V3_URL","V3_URL_REGEX","EXISTING_SCRIPT_MESSAGE","stripePromise","loadScript","params","Promise","resolve","reject","window","document","Stripe","console","warn","script","scripts","querySelectorAll","concat","i","test","src","findScript","queryString","advancedFraudSignals","createElement","headOrBody","head","body","Error","appendChild","injectScript","addEventListener","error","stripePromise$1","then","loadCalled","err","loadStripe","_len","arguments","args","Array","_key","startTime","Date","now","maybeStripe","stripe","apply","undefined","_registerWrapper","name","version","registerWrapper","initStripe","SHIPPING_PRICE_ID","props","lineItems","setStripe","React","async","stripeObj","fetchStripe","disabled","onClick","redirectToCheckout","price","quantity","_toConsumableArray","mode","billingAddressCollection","shippingAddressCollection","allowedCountries","successUrl","cancelUrl","products","isEnabled","useIsEnabled","FLAGS","cart","updateQuantity","useContext","cartContext","map","item","id","priceId","key","className","GatsbyImage","image","getImage","file","alt","H2","H3","Checkout","Head","allGoogleSpreadsheetPetitsAnimauxProducts","data","page","nodes","CommonHead","Object","assign","allGooglePhotosPhoto","MainSectionWrapper","Cart"],"sourceRoot":""}